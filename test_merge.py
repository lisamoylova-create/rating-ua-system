#!/usr/bin/env python3
"""
–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –∑–ª–∏—Ç—Ç—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —Å–∏—Å—Ç–µ–º–∏ –†–µ–π—Ç–∏–Ω–≥.UA
"""
import pandas as pd
import os
from datetime import datetime

def create_test_files():
    """–°—Ç–≤–æ—Ä—é—î —Ç–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∑–ª–∏—Ç—Ç—è"""
    
    # –¢–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª 1 - –±–∞–∑–æ–≤—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
    companies_1 = [
        {'–Ñ–î–†–ü–û–£': '12345678', '–ù–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó': '–¢–û–í "–¢–µ—Å—Ç 1"', '–û–±–ª–∞—Å—Ç—å': '–ö–∏—ó–≤—Å—å–∫–∞', 
         '–ü–µ—Ä—Å–æ–Ω–∞–ª (2019 —Ä.)': 50, '–ß–∏—Å—Ç–∏–π –¥–æ—Ö—ñ–¥ –≤—ñ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ü—ñ—ó': 1000000,
         '–ß–∏—Å—Ç–∏–π —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–∏–±—É—Ç–æ–∫': 100000},
        {'–Ñ–î–†–ü–û–£': '87654321', '–ù–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó': '–¢–û–í "–¢–µ—Å—Ç 2"', '–û–±–ª–∞—Å—Ç—å': '–õ—å–≤—ñ–≤—Å—å–∫–∞', 
         '–ü–µ—Ä—Å–æ–Ω–∞–ª (2019 —Ä.)': 25, '–ß–∏—Å—Ç–∏–π –¥–æ—Ö—ñ–¥ –≤—ñ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ü—ñ—ó': 500000,
         '–ß–∏—Å—Ç–∏–π —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–∏–±—É—Ç–æ–∫': 50000},
    ]
    
    # –¢–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª 2 - –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–æ–º–ø–∞–Ω—ñ—ó + –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–∏—Ö
    companies_2 = [
        {'–Ñ–î–†–ü–û–£': '12345678', '–ù–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó': '–¢–û–í "–¢–µ—Å—Ç 1 –û–ù–û–í–õ–ï–ù–û"', '–û–±–ª–∞—Å—Ç—å': '–ö–∏—ó–≤—Å—å–∫–∞', 
         '–ü–µ—Ä—Å–æ–Ω–∞–ª (2019 —Ä.)': 75, '–ß–∏—Å—Ç–∏–π –¥–æ—Ö—ñ–¥ –≤—ñ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ü—ñ—ó': 1500000,
         '–ß–∏—Å—Ç–∏–π —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–∏–±—É—Ç–æ–∫': 150000},  # –û–Ω–æ–≤–ª–µ–Ω—ñ –¥–∞–Ω—ñ
        {'–Ñ–î–†–ü–û–£': '11111111', '–ù–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó': '–¢–û–í "–ù–æ–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—è"', '–û–±–ª–∞—Å—Ç—å': '–û–¥–µ—Å—å–∫–∞', 
         '–ü–µ—Ä—Å–æ–Ω–∞–ª (2019 —Ä.)': 30, '–ß–∏—Å—Ç–∏–π –¥–æ—Ö—ñ–¥ –≤—ñ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ü—ñ—ó': 750000,
         '–ß–∏—Å—Ç–∏–π —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–∏–±—É—Ç–æ–∫': 75000},  # –ù–æ–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—è
    ]
    
    df1 = pd.DataFrame(companies_1)
    df2 = pd.DataFrame(companies_2)
    
    test_file_1 = 'test_companies_1.xlsx'
    test_file_2 = 'test_companies_2.xlsx'
    
    df1.to_excel(test_file_1, index=False)
    df2.to_excel(test_file_2, index=False)
    
    print(f"‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏:")
    print(f"   üìÑ {test_file_1} - 2 –∫–æ–º–ø–∞–Ω—ñ—ó")
    print(f"   üìÑ {test_file_2} - 1 –æ–Ω–æ–≤–ª–µ–Ω–Ω—è + 1 –Ω–æ–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—è")
    
    return test_file_1, test_file_2

def test_merge_functionality():
    """–¢–µ—Å—Ç—É—î —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –∑–ª–∏—Ç—Ç—è —Ñ–∞–π–ª—ñ–≤"""
    print("üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–ª–∏—Ç—Ç—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è –†–µ–π—Ç–∏–Ω–≥.UA")
    print("=" * 50)
    
    try:
        # –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏
        file1, file2 = create_test_files()
        
        print(f"\nüìä –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–ª–∏—Ç—Ç—è:")
        print("   ‚Ä¢ –¢–û–í '–¢–µ—Å—Ç 1' - –æ–Ω–æ–≤–ª–µ–Ω—ñ –¥–∞–Ω—ñ (–ø–µ—Ä—Å–æ–Ω–∞–ª: 75, –¥–æ—Ö—ñ–¥: 1,500,000)")
        print("   ‚Ä¢ –¢–û–í '–¢–µ—Å—Ç 2' - –±–µ–∑ –∑–º—ñ–Ω")
        print("   ‚Ä¢ –¢–û–í '–ù–æ–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—è' - –Ω–æ–≤–∞ –∑–∞–ø–∏—Å")
        print("   üìà –í—Å—å–æ–≥–æ: 3 –∫–æ–º–ø–∞–Ω—ñ—ó")
        
        print(f"\nüöÄ –î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:")
        print(f"   1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª {file1} —á–µ—Ä–µ–∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å")
        print(f"   2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ 2 –∫–æ–º–ø–∞–Ω—ñ—ó")
        print(f"   3. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª {file2}")
        print(f"   4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ:")
        print(f"      ‚Ä¢ –¢–û–í '–¢–µ—Å—Ç 1' –æ–Ω–æ–≤–ª–µ–Ω–æ (–Ω–∞–∑–≤–∞, –ø–µ—Ä—Å–æ–Ω–∞–ª, —Ñ—ñ–Ω–∞–Ω—Å–∏)")
        print(f"      ‚Ä¢ –¢–û–í '–ù–æ–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—è' –¥–æ–¥–∞–Ω–æ")
        print(f"      ‚Ä¢ –í—Å—å–æ–≥–æ 3 –∫–æ–º–ø–∞–Ω—ñ—ó –≤ —Å–∏—Å—Ç–µ–º—ñ")
        
        print(f"\nüí° –ö–ª—é—á–æ–≤—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:")
        print(f"   ‚úì –Ñ–î–†–ü–û–£ —è–∫ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –∫–ª—é—á")
        print(f"   ‚úì –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–∏—Ö –∑–∞–ø–∏—Å—ñ–≤")
        print(f"   ‚úì –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤")
        print(f"   ‚úì –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö")
        
        return True
        
    except Exception as e:
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è: {e}")
        return False

if __name__ == '__main__':
    success = test_merge_functionality()
    if success:
        print(f"\n‚úÖ –¢–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –≥–æ—Ç–æ–≤—ñ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∑–ª–∏—Ç—Ç—è!")
    else:
        print(f"\n‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤!")